data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index %>% str()
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[[selection]] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[[selection]] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index %>% str()
load_all()
selection <- "steo"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[[selection]] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[[selection]] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index %>% str()
route_index
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- d_updates
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- d_updates
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index %>% str()
route_index$international
selection <- "international"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index %>% str()
route_index$steo %>% str()
eiatools::data_index$steo
eiatools::data_index$international
selection <- "petroleum"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
selection <- "coal"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
route_index$coal
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
load_all()
eiatools::data_index
# Selecting Update Ranges
paths <- eia_meta("", creds::eia_key) %>% get_routes()
paths$id
selection <- "crude-oil-imports"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
paths$id
selection <- "electricity"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
paths <- eia_meta("", creds::eia_key) %>% get_routes()
paths$id
selection <- "electricity"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
eiatools::route_index$electricity %>% dplyr::filter(api_endpoint == "electricity/facility-fuel")
eiatools::route_index$electricity %>% dplyr::filter(api_endpoint == "electricity/facility-fuel") %>% data_tree(creds::eia_key)
load_all()
eiatools::route_index$electricity %>% dplyr::filter(api_endpoint == "electricity/facility-fuel") %>% data_tree(creds::eia_key)
eia_call("https://api.eia.gov/v2/electricity/facility-fuel/data?api_key=UKCNbCB0m8aixfPBshQU3Jdlz2uZsEbG2HebvhHX&length=5000&offset=0&sort[0][column]=period&sort[0][direction]=desc") -> test
View(test)
load_all()
eiatools::route_index$electricity %>% dplyr::filter(api_endpoint == "electricity/facility-fuel") %>% data_tree(creds::eia_key)
paths <- eia_meta("", creds::eia_key) %>% get_routes()
paths$id
selection <- "electricity"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
paths$id
selection <- "natural-gas"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
paths$id
selection <- "nuclear-outages"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
paths$id
selection <- "seds"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
paths$id
selection <- "densified-biomass"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
paths$id
selection <- "total-energy"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
paths$id
selection <- "aeo"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
paths$id
selection <- "ieo"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::data_index
paths$id
selection <- "co2-emissions"
route_table <- eiatools::route_index[selection][[1]]
d_updates <- NULL
for(r in 1:nrow(route_table)){
d_out <- data_tree(route_table[r,], creds::eia_key)
if(!is.null(d_out)){
if(is.null(d_updates)){
d_updates <- d_out
}else{
d_updates <- dplyr::bind_rows(d_updates, d_out)
}
tryCatch({
data_index_old <- eiatools::data_index
print("Ready to update existing index")
data_index_old[selection] <- list(d_updates)
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
print("Overlaying existing index")
}, error = function(e){
data_index <- list()
data_index[selection] <- list(d_updates)
usethis::use_data(data_index, overwrite = T)
print("Doesn't exist yet.")
})
load_all()
eiatools::dataindex %>% names()
eiatools::data_index %>% names()
paths$id
paths$id %>% data.frame(id = .)
paths$id %>% data.frame(id = .) %>% dplyr::filter(id %in% (eiatools::data_index %>% names()))
paths$id %>% data.frame(id = .) %>% dplyr::filter(!id %in% (eiatools::data_index %>% names()))
eiatools::data_index
View(data_index)
library(devtools)
load_all()
data_index$petroleum %>% names()
route_index$petroleum %>% names()
data_index_old <- eiatools::data_index
for(p in 1:nrow(data_index_old)){
print(data_index_old[p,])
}
for(p in 1:nrow(data_index_old)){
print(data_index_old[p,])
}
data_index_old <- eiatools::data_index
for(p in 1:length(data_index_old)){
print(data_index_old[p])
}
for(p in 1:length(data_index_old)){
data_index_old[p] <- data_index_old[p] %>% dplyr::mutate(nickname = NA)
}
str(data_index_old[1])
for(p in 1:length(data_index_old)){
data_index_old[p][[1]] <- data_index_old[p][[1]] %>% dplyr::mutate(nickname = NA)
}
usethis::use_data(data_index, overwrite = T)
load_all()
eiatools::data_index
data_index$petroleum %>% names()
# Ensuring placeholder cols exist
data_index_old <- eiatools::data_index
for(p in 1:length(data_index_old)){
data_index_old[p][[1]] <- data_index_old[p][[1]] %>% dplyr::mutate(nickname = NA)
}
data_index <- data_index_old
usethis::use_data(data_index, overwrite = T)
load_all()
eiatools::data_index
use_r("collapse_index")
load_all()
collapse_index(data_tree)
collapse_index(data_index)
collapse_index(route_index)
